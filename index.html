<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vigard Calc — V5</title>
  <style>
    body{font-family:system-ui;margin:0;padding:20px;background:#f7f7f8;color:#111}
    h1{margin:0 0 20px;font-size:22px}
    .card{background:#fff;border:1px solid #ccc;border-radius:10px;padding:16px;margin-bottom:16px}
    label{display:block;font-size:14px;margin:8px 0 4px}
    input,select,button{padding:6px 8px;border:1px solid #ccc;border-radius:6px;font-size:14px}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border:1px solid #ddd;padding:6px;text-align:left;font-size:13px}
    th{background:#f0f0f0}
  </style>
</head>
<body>
  <h1>Вигард — калькулятор наливных грузов (V5)</h1>

  <div class="card">
    <h3>Тягачи</h3>
    <button onclick="addTractor()">+ Добавить тягач</button>
    <table id="tractorTable"><thead><tr><th>Госномер</th><th>Оси</th></tr></thead><tbody></tbody></table>
  </div>

  <div class="card">
    <h3>Грузы</h3>
    <button onclick="addCargo()">+ Добавить груз</button>
    <table id="cargoTable"><thead>
      <tr><th>Название</th><th>ρ (кг/л)</th><th>Объём</th><th>Ед.</th><th>Масса, кг</th></tr>
    </thead><tbody></tbody></table>
  </div>

  <div class="card">
    <h3>Маршрут</h3>
    <label>Откуда</label><input id="from" placeholder="Кропоткин">
    <label>Куда</label><input id="to" placeholder="Краснодар">
    <button onclick="getDistance()">Рассчитать расстояние</button>
    <div id="distOut"></div>
  </div>

<script>
// ======= Данные =======
let tractors=[]; 
let cargos=[];

// ======= Тягачи =======
function addTractor(){
  const num=prompt('Госномер тягача'); if(!num) return;
  const ax=prompt('Количество осей (2 или 3)','2');
  tractors.push({num,ax:parseInt(ax)}); renderTractors();
}
function renderTractors(){
  const tb=document.querySelector('#tractorTable tbody'); tb.innerHTML='';
  tractors.forEach(t=>{tb.innerHTML+=`<tr><td>${t.num}</td><td>${t.ax}</td></tr>`});
}

// ======= Грузы =======
function addCargo(){
  const name=prompt('Название груза'); if(!name) return;
  const rho=parseFloat(prompt('Плотность, кг/л')); if(!rho) return;
  const vol=parseFloat(prompt('Объём')); if(!vol) return;
  const unit=prompt('Единица (л/т/м3)','л');
  let mass=0; 
  if(unit==='л'){mass=vol*rho;} 
  else if(unit==='т'){mass=vol*1000;} 
  else if(unit==='м3'){mass=vol*rho*1000;} 
  cargos.push({name,rho,vol,unit,mass}); renderCargos();
}
function renderCargos(){
  const tb=document.querySelector('#cargoTable tbody'); tb.innerHTML='';
  cargos.forEach(c=>{tb.innerHTML+=`<tr><td>${c.name}</td><td>${c.rho}</td><td>${c.vol}</td><td>${c.unit}</td><td>${Math.round(c.mass)}</td></tr>`});
}

// ======= Google Maps =======
function getDistance(){
  const from=document.getElementById('from').value;
  const to=document.getElementById('to').value;
  if(!from||!to){alert('Укажите города');return;}
  const service=new google.maps.DistanceMatrixService();
  service.getDistanceMatrix({origins:[from],destinations:[to],travelMode:'DRIVING'},(res,status)=>{
    if(status!=='OK'){alert('Ошибка API: '+status);return;}
    const km=res.rows[0].elements[0].distance.value/1000;
    document.getElementById('distOut').innerText='Расстояние: '+km+' км';
  });
}
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places"></script>
</body>
</html>
